name: CI
on: push

jobs:
  build_container:
    name: Build
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Set Node.js version 
        uses: actions/setup-node@v2
        with:
          node-version: '14'

      - name: Install packages
        run: npm install

      - name: Install Lazydocs
        run: pip install lazydocs

      - name: Moving build to artifacts directory
        run: sh ./generate-docs.sh

      - name: Moving into another repo
        uses: actions/checkout@v2
        with:
          repository: sanwal-truefoundry/MLFoundry-Clone
          ref: 'main'
          token: ${{ secrets.TOKEN }}
          path: tmp_ahc
        
      - name: Commit new file
        run: |
          cd tmp_ahc
          git config user.name github-action
          git add docs/api-docs/mlfoundry_api.py.md
          git commit -m "[CI] Commit new file mlfoundry_api.py.md"
          git push